---
layout: default
title: HHC 2019
permalink: /hhc2019/
---

# Holiday Hack Challenge 2019
This christmas season I attended [Kringlecon 2: Turtle Doves](https://2019.kringlecon.com/invite) at the North Pole and participated in the [SANS Holiday Hack Challenge](https://holidayhackchallenge.com/2019/).  As always, it was a fantastic experience filled with much fun and learning.  I want to send a huge thanks to the Counter Hack team and SANS for putting on such a great event!

Without further ado, here's my experience.

## Arriving at the North Pole
Upon arriving at the North Pole, I was greeted by Santa himself.

![Santa at the North Pole](/assets/images/kringlecon_santa.png)

> Welcome to the North Pole and KringleCon 2!
>
> Last year, KringleCon hosted over 17,500 attendees and my castle got a little crowded.
>
> We moved the event to Elf University (Elf U for short), the North Pole’s largest venue.
>
> Please feel free to explore, watch talks, and enjoy the con!

With this conversation with Santa, I unlocked my first [narrative](#narrative).  I also came across my first [terminal challenge](#terminal_challenges).  KringleCon 2 is officially under way!

In the rest of this report, I will walk through each terminal challenge and objective put forth before me.  Cheers and happy hacking!

## Terminal Challenges[](#terminal_challenges)

| Elf                | Name                      | Location           |
|--------------------|---------------------------|--------------------|
|Bushy Evergreen     | [Escape ed](#escape_ed)   | Train Station      |

### Escape ed[](#escape_ed)
In the Train Station, Busy Evergreen introduces us to the Escape Ed terminal challenge.

> Hi, I'm Bushy Evergreen. Welcome to Elf U!
>
> I'm glad you're here. I'm the target of a terrible trick.
>
> Pepper Minstix is at it again, sticking me in a text editor.
>
> Pepper is forcing me to learn ed.
>
> Even the hint is ugly. Why can't I just use Gedit?
>
> Please help me just quit the grinchy thing.

**Hint**: [ed Editor Basics](http://cs.wellesley.edu/~cs249/Resources/ed_is_the_standard_text_editor.html)

![Escape ed Terminal](/assets/images/escape_ed1.png)

Upon entering the terminal, we were dropped into the ed editor, a linux-based editor similar to vi. To complete the challenge, we must exit the ed editor.

To exit the ed editor, we simply type "wq" and press enter.  Upon doing this, the editor exits and we get the "You did it! Congratulations!" message indicating that we completed the challenge successfully!

![Escape ed Success](/assets/images/escape_ed2.png)

Completing this terminal gave us the achievement "Escape Ed".

Bushy rewarded us greatly for helping him with this task, including dropping two hints that will come in handy on [Objective 3](#objective3)

> Wow, that was much easier than I'd thought.
> 
> Maybe I don't need a clunky GUI after all!
> 
> Have you taken a look at the password spray attack artifacts?
> 
> I'll bet that DeepBlueCLI tool is helpful.
> 
> You can check it out on GitHub.
> 
> It was written by that Eric Conrad.
> 
> He lives in Maine - not too far from here!

## Objectives[](#objectives)

During the course of exploring ElfU, I was challenged with the following objectives.  The sections below explain the steps taken in each objective, including how they were unlocked, any hints that were provided, what steps were taken to solve the objective, and the outcome.  Enjoy!

### Objective 0: Talk to Santa in the Quad[](#objective0)

#### Task 

Enter the campus quad and talk to Santa.

#### Walk Through

After leaving the train station, we entered The Quad at ElfU where Santa was waiting for us.

To complete this objective, we talked to Santa in the quad and this is what he had to say.

> This is a little embarrassing, but I need your help.
> 
> Our KringleCon turtle dove mascots are missing!
> 
> They probably just wandered off.
> 
> Can you please help find them?
> 
> To help you search for them and get acquainted with KringleCon, I’ve created some objectives for you. You can see them in your badge.
> 
> Where's your badge? Oh! It's that big, circle emblem on your chest - give it a tap!
> 
> We made them in two flavors - one for our new guests, and one for those who've attended both KringleCons.

Thanks for the tip on the badge Santa!  Talking with Santa also unlocked many of the other objectives below.

#### Solution

Locate Santa in the quad and click on him to say hello.

### Objective 1: Find the Turtle Doves[](#objective1)

#### Task 

Find the missing turtle doves.

#### Walk Through

During the course of exploring ElfU, we entered the Student Union building.  It's a great place for students and visitors alike to hang out and meet people and is conveniently located across the quad from the train station!

Like most places at the North Pole, it was warm and cozy thanks to a roaring fire in the fireplace, which is where we found the two turtle doves, Michael and Jane, relaxing and warming up.

![Michael and Jane - Two Turtle Doves](/assets/images/turtle_doves.png)

Another objective down!

#### Solution

Locate the Two Turtle Doves and click on them to say hello.

### Objective 2: Unredact Threatening Document[](#objective2)

#### Task 
Someone sent a threatening letter to Elf University. What is the first word in ALL CAPS in the subject line of the letter? Please find the letter in the Quad.

#### Walk Through

While exploring ElfU and the quad, we found [a letter](https://downloads.elfu.org/LetterToElfUPersonnel.pdf) in the corner between the Student Union and Hermey Hall.  After picking up the letter, it was found to be heavily redacted.

![Redacted Letter](/assets/images/letter1.png)

However, we paid attention to the news this year, and recalled a certain incident with a [poorly redacted pdf](https://www.wired.com/story/paul-manafort-bad-tech-pdfs-passwords/).  Alas, attempting the same technique of copying and pasting from the pdf revealed that we could still get to the redacted text!

![Copying the Redacted Letter](/assets/images/letter2.png)

And that revealed to us the contents of the redacted letter as follows.

> From: A Concerned and Aggrieved Character
>
> Subject: DEMAND: Spread Holiday Cheer to Other Holidays and Mythical Characters… OR ELSE!
>
> Attention All Elf University Personnel,
>
> It remains a constant source of frustration that Elf University and the entire operation at the North Pole focuses exclusively on Mr. S. Claus and his year-end holiday spree. We URGE you to consider lending your considerable resources and expertise in providing merriment, cheer, toys, candy, and much more to other holidays year-round, as well as to other mythical characters.
>
> For centuries, we have expressed our frustration at your lack of willingness to spread your cheer beyond the inaptly-called “Holiday Season.” There are many other perfectly fine holidays and mythical characters that need your direct support year-round. 
>
> If you do not accede to our demands, we will be forced to take matters into our own hands. We do not make this threat lightly. You have less than six months to act demonstrably. 
>

It appears that someone at the North Pole is not so filled with holiday cheer and is threatening the North Pole and Christmas everywhere!

#### Solution

The first word in ALL CAPS in the subject line of the letter is...

DEMAND


### Objective 3: Windows Log Analysis: Evaluate Attack Outcome[](#objective3)

#### Task 

We're seeing attacks against the Elf U domain! Using [the event log data](https://downloads.elfu.org/Security.evtx.zip), identify the user account that the attacker compromised using a password spray attack. Bushy Evergreen is hanging out in the train station and may be able to help you out.

#### Hints

[Deep Blue CLI on Github](https://github.com/sans-blue-team/DeepBlueCLI)
[Eric Conrad on DeepBlueCLI](https://www.ericconrad.com/2016/09/deepbluecli-powershell-module-for-hunt.html)

#### Walk Through

#### Solution


### Objective 4: Windows Log Analysis: Determine Attacker Technique[](#objective4)

#### Task 

Using [these normalized Sysmon logs](https://downloads.elfu.org/sysmon-data.json.zip), identify the tool the attacker used to retrieve domain password hashes from the lsass.exe process. For hints on achieving this objective, please visit Hermey Hall and talk with SugarPlum Mary.

#### Hints

#### Walk Through

#### Solution

### Objective 5: Network Log Analysis: Determine Compromised System[](#objective5)

#### Task 

The attacks don't stop! Can you help identify the IP address of the malware-infected system using these [Zeek logs](https://downloads.elfu.org/elfu-zeeklogs.zip)? For hints on achieving this objective, please visit the Laboratory and talk with Sparkle Redberry.

#### Hints

#### Walk Through

#### Solution

### Objective 6: Splunk[](#objective6)

#### Task 

Access [https://splunk.elfu.org/](https://splunk.elfu.org/) as elf with password elfsocks. What was the message for Kent that the adversary embedded in this attack? The SOC folks at that link will help you along! For hints on achieving this objective, please visit the Laboratory in Hermey Hall and talk with Prof. Banas.

#### Hints

#### Walk Through

#### Solution

### Objective 7: Get Access to the Steam Tunnels[](#objective7)

#### Task 

Gain access to the steam tunnels. Who took the turtle doves? Please tell us their first and last name. For hints on achieving this objective, please visit Minty's dorm room and talk with Minty Candy Cane.

#### Hints

#### Walk Through

#### Solution

### Objective 8: Bypassing the Frido Sleigh CAPTEHA[](#objective8)

#### Task 

Help Krampus beat the [Frido Sleigh contest](https://fridosleigh.com/). For hints on achieving this objective, please talk with Alabaster Snowball in the Speaker Unpreparedness Room.

#### Hints

#### Walk Through

#### Solution

### Objective 9: Retrieve Scraps of Paper from Server[](#objective9)

#### Task 

Gain access to the data on the [Student Portal](https://studentportal.elfu.org/) server and retrieve the paper scraps hosted there. What is the name of Santa's cutting-edge sleigh guidance system? For hints on achieving this objective, please visit the dorm and talk with Pepper Minstix.

#### Hints

#### Walk Through

#### Solution

### Objective 10: Recover Cleartext Document[](#objective10)

#### Task 

The [Elfscrow Crypto](https://downloads.elfu.org/elfscrow.exe) tool is a vital asset used at Elf University for encrypting SUPER SECRET documents. We can't send you the source, but we do have [debug symbols](https://downloads.elfu.org/elfscrow.pdb) that you can use.

Recover the plaintext content for this [encrypted document](https://downloads.elfu.org/ElfUResearchLabsSuperSledOMaticQuickStartGuideV1.2.pdf.enc). We know that it was encrypted on December 6, 2019, between 7pm and 9pm UTC.

What is the middle line on the cover page? (Hint: it's five words)

For hints on achieving this objective, please visit the NetWars room and talk with Holly Evergreen.


#### Hints

#### Walk Through

#### Solution

### Objective 11: Open the Sleigh Shop Door[](#objective11)

#### Task 

Visit Shinny Upatree in the Student Union and help solve their problem. What is written on the paper you retrieve for Shinny?

For hints on achieving this objective, please visit the Student Union and talk with Kent Tinseltooth.

#### Hints

#### Walk Through

#### Solution

### Objective 12: Filter Out Poisoned Sources of Weather Data[](#objective12)

#### Task 

Use the data supplied in the [Zeek JSON logs](https://downloads.elfu.org/http.log.gz) to identify the IP addresses of attackers poisoning Santa's flight mapping software. [Block the 100 offending sources of information to guide Santa's sleigh](https://srf.elfu.org/) through the attack. Submit the Route ID ("RID") success value that you're given. For hints on achieving this objective, please visit the Sleigh Shop and talk with Wunorse Openslae.

#### Hints

#### Walk Through

#### Solution


## Narrative[](#narrative)

> Whose grounds these are, I think I know
>
> His home is in the North Pole though
>
> He will not mind me traipsing here
>
> To watch his students learn and grow

* * *
