---
layout: default
title: HHC 2019
permalink: /hhc2019/
---

# Holiday Hack Challenge 2019
This christmas season I attended [Kringlecon 2: Turtle Doves](https://2019.kringlecon.com/invite) at the North Pole and participated in the [SANS Holiday Hack Challenge](https://holidayhackchallenge.com/2019/).  As always, it was a fantastic experience filled with much fun and learning.  I want to send a huge thanks to the Counter Hack team and SANS for putting on such a great event!

Without further ado, here's my experience.

## Arriving at the North Pole
Upon arriving at the North Pole, I was greeted by Santa himself.

![Santa at the North Pole](/assets/images/kringlecon_santa.png)

> Welcome to the North Pole and KringleCon 2!
>
> Last year, KringleCon hosted over 17,500 attendees and my castle got a little crowded.
>
> We moved the event to Elf University (Elf U for short), the North Pole’s largest venue.
>
> Please feel free to explore, watch talks, and enjoy the con!

With this conversation with Santa, I unlocked my first [narrative](#narrative).  I also came across my first [terminal challenge](#terminal_challenges).  KringleCon 2 is officially under way!

In the rest of this report, I will walk through each terminal challenge and objective put forth before me.  Cheers and happy hacking!

## Terminal Challenges[](#terminal_challenges)

| Elf                | Name                      | Location           |
|--------------------|---------------------------|--------------------|
|Bushy Evergreen     | [Escape ed](#escape_ed)   | Train Station      |

### Escape ed[](#escape_ed)
In the Train Station, Busy Evergreen introduces us to the Escape Ed terminal challenge.

> Hi, I'm Bushy Evergreen. Welcome to Elf U!
>
> I'm glad you're here. I'm the target of a terrible trick.
>
> Pepper Minstix is at it again, sticking me in a text editor.
>
> Pepper is forcing me to learn ed.
>
> Even the hint is ugly. Why can't I just use Gedit?
>
> Please help me just quit the grinchy thing.

**Hint**: [ed Editor Basics](http://cs.wellesley.edu/~cs249/Resources/ed_is_the_standard_text_editor.html)

![Escape ed Terminal](/assets/images/escape_ed1.png)

Upon entering the terminal, we were dropped into the ed editor, a linux-based editor similar to vi. To complete the challenge, we must exit the ed editor.

To exit the ed editor, we simply type "wq" and press enter.  Upon doing this, the editor exits and we get the "You did it! Congratulations!" message indicating that we completed the challenge successfully!

![Escape ed Success](/assets/images/escape_ed2.png)

Completing this terminal gave us the achievement "Escape Ed".

Bushy rewarded us greatly for helping him with this task, including dropping two hints that will come in handy on [Objective 3](#objective3)

> Wow, that was much easier than I'd thought.
> 
> Maybe I don't need a clunky GUI after all!
> 
> Have you taken a look at the password spray attack artifacts?
> 
> I'll bet that DeepBlueCLI tool is helpful.
> 
> You can check it out on GitHub.
> 
> It was written by that Eric Conrad.
> 
> He lives in Maine - not too far from here!

## Objectives[](#objectives)

During the course of exploring ElfU, I was challenged with the following objectives.  The sections below explain the steps taken in each objective, including how they were unlocked, any hints that were provided, what steps were taken to solve the objective, and the outcome.  Enjoy!

### Objective 0: Talk to Santa in the Quad[](#objective0)

**Details**: Enter the campus quad and talk to Santa.

After leaving the train station, we entered The Quad at ElfU where Santa was waiting for us.

To complete this objective, we talked to Santa in the quad and this is what he had to say.

> This is a little embarrassing, but I need your help.
> 
> Our KringleCon turtle dove mascots are missing!
> 
> They probably just wandered off.
> 
> Can you please help find them?
> 
> To help you search for them and get acquainted with KringleCon, I’ve created some objectives for you. You can see them in your badge.
> 
> Where's your badge? Oh! It's that big, circle emblem on your chest - give it a tap!
> 
> We made them in two flavors - one for our new guests, and one for those who've attended both KringleCons.

Thanks for the tip on the badge Santa!  Talking with Santa also unlocked many of the other objectives below.

### Objective 1: Find the Turtle Doves[](#objective1)

**Details**: Find the missing turtle doves.

During the course of exploring ElfU, we entered the Student Union building.  It's a great place for students and visitors alike to hang out and meet people and is conveniently located across the quad from the train station!

Like most places at the North Pole, it was warm and cozy thanks to a roaring fire in the fireplace, which is where we found the two turtle doves, Michael and Jane, relaxing and warming up.

![Michael and Jane - Two Turtle Doves](/assets/images/turtle_doves.png)

Another objective down!

### Objective 2: Unredact Threatening Document[](#objective2)

**Details**: Someone sent a threatening letter to Elf University. What is the first word in ALL CAPS in the subject line of the letter? Please find the letter in the Quad.

While exploring ElfU and the quad, we found [a letter](https://downloads.elfu.org/LetterToElfUPersonnel.pdf) in the corner between the Student Union and Hermey Hall.  After picking up the letter, it was found to be heavily redacted.

![Redacted Letter](/assets/images/letter1.png)

However, we paid attention to the news this year, and recalled a certain incident with a [poorly redacted pdf](https://www.wired.com/story/paul-manafort-bad-tech-pdfs-passwords/).  Alas, attempting the same technique of copying and pasting from the pdf revealed that we could still get to the redacted text!

![Copying the Redacted Letter](/assets/images/letter2.png)

And that revealed to us the contents of the redacted letter as follows.

> From: A Concerned and Aggrieved Character
>
> Subject: DEMAND: Spread Holiday Cheer to Other Holidays and Mythical Characters… OR ELSE!
>
> Attention All Elf University Personnel,
>
> It remains a constant source of frustration that Elf University and the entire operation at the North Pole focuses exclusively on Mr. S. Claus and his year-end holiday spree. We URGE you to consider lending your considerable resources and expertise in providing merriment, cheer, toys, candy, and much more to other holidays year-round, as well as to other mythical characters.
>
> For centuries, we have expressed our frustration at your lack of willingness to spread your cheer beyond the inaptly-called “Holiday Season.” There are many other perfectly fine holidays and mythical characters that need your direct support year-round. 
>
> If you do not accede to our demands, we will be forced to take matters into our own hands. We do not make this threat lightly. You have less than six months to act demonstrably. 
>

It appears that someone at the North Pole is not so filled with holiday cheer and is threatening the North Pole and Christmas everywhere!

**Answer**: DEMAND


### Objective 3: Windows Log Analysis: Evaluate Attack Outcome[](#objective3)

### Objective 4: Windows Log Analysis: Determine Attacker Technique[](#objective4)

### Objective 5: Network Log Analysis: Determine Compromised System[](#objective5)

### Objective 6: Splunk[](#objective6)

### Objective 7: Get Access to the Steam Tunnels[](#objective7)

### Objective 8: Bypassing the Frido Sleigh CAPTEHA[](#objective8)

### Objective 9: Retrieve Scraps of Paper from Server[](#objective9)

### Objective 10: Recover Cleartext Document[](#objective10)

### Objective 11: Open the Sleigh Shop Door[](#objective11)

### Objective 12: Filter Out Poisoned Sources of Weather Data[](#objective12)


## Narrative[](#narrative)

> Whose grounds these are, I think I know
>
> His home is in the North Pole though
>
> He will not mind me traipsing here
>
> To watch his students learn and grow

* * *
